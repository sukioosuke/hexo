---
title: 模型选择
date: 2019-07-19 00:04:24
categories: 统计学
tags: [统计学, 模型, 模型选择]
---
模型选择有两种常用方法：**正则化和交叉验证**
### 正则化
正则化是结构风险最小化策略的实现。在经验风险上加一个正则项或者罚项，一般是模型复杂度的单调递增函数，模型越复杂，则正则化项的值就越大。
正则化一般具有如下形式：
$$ \min_{f\in\mathcal{F}} \frac{1}{N}\sum_{i=1}^{N}L(y_i,f(x_i))+\lambda J(f) $$
其中，第1项是经验风险，第2项是正则化项。$\lambda \ge 0$为调节两者比重的系数。

正则化符合奥卡姆剃刀原理，在所有可选择的模型中，能够很好的解释已知数据并且简单的才是最好的模型。

#### 例1,L2正则化项
回归问题中，损失函数是平方损失，正则化项可以是参数向量的$L_2$范数
$$ L(w)=\frac{1}{N}\sum_{i=1}^N(f(x_i;w)-y_i)^2+\frac{\lambda}{2}{\lVert w\rVert}^2 $$
这里$\lVert w \rVert$表示参数向量w的$L_2$范数，即
$$ {\lVert x \rVert}_{2}=\sqrt{\sum_{i=1}^{N}{x_i^2}} $$
当回归模型中的多项式项数很多时，$L_2$范数的值会收到$w_i$的影响，其中i越小，其对应的权重越重要，即经过正则化学习，高次项前的系数会变得很小，最后的曲线类似一条直线，这就是让模型变成了一个简单的模型。（具体推导可详见*[6]一文搞懂深度学习正则化的L2范数*）

> * 正则化让模型根据训练数据中常见的模式来学习相对简单的模型，无正则化的模型用大参数学习大噪声。
> * L2正则化通过权重衰减，保证了模型的简单，提高了泛化能力。

#### 例2，L0、L1正则化项
当使用L0、L1正则化项时，对模型的影响是让模型的影响因子变得稀疏，进行特征自动选择。
##### L0正则化
 L0范数指的是向量中非零元素的个数，L0正则化就是限制非零元素的个数在一定的范围，这很明显会带来稀疏。一般而言，用L0范数实现稀疏是一个NP-hard问题，因此人们一般使用L1正则化来对模型进行稀疏约束。
##### L1正则化
L1范数是计算向量中每个元素绝对值的和,可以看出，L1范数让w向0靠近，从而对于小权重能很快的减小，对大权重减小较慢，从而使模型的权重集中在高重要度的特征上。使得最终权重w变得稀疏。
$$ {\lVert x\rVert}_1 = \sum_{i=1}^N |x_i| $$

### 交叉验证
另一种常用的模型选择方法是交叉验证。
在数据集充沛的前提下，将数据集简单的分为三部分，分别为训练集、验证集和测试集。训练集用来训练模型，验证集用于模型的选择，而测试集用于最终对学习方法的评估。但往往在实际应用中数据并不充足，为了选择好的模型，反复的使用数据，把给定的数据进行切分，将切分的数据集组合为训练集和测试集，在此基础上反复进行训练测试以及模型选择，这就是交叉验证。

#### 简单交叉验证
1. 随机的将已给数据分成两部分，一部分作为训练集，一部分作为测试集
2. 用训练集在各种条件下（如不同的参数个数等）训练模型，从而得到不同的模型
3. 在测试集上评价各个模型的测试误差，选取测试误差最小的模型

#### S折交叉验证
S折交叉验证是目前应用最多的方法。
1. 随机将已给数据切分为S个互不相交的大小相同的子集
2. 利用S-1个子集的数据训练模型，利用余下的子集测试模型
3. 对该过程可能的S种选择重复进行，最后选出S次评价中平均测试误差最小的模型

#### 留一交叉验证
留一交叉验证是S折交叉验证的特殊情况，这里S=N，N是给定数据集的数据个数。

参考文献：
[1] 从高斯消元法到矩阵乘法 https://www.matongxue.com/madocs/755.html
[2] 如何理解矩阵乘法？ https://www.matongxue.com/madocs/555.html
[3] 如何理解相似矩阵？ https://www.matongxue.com/madocs/491.html
[4] 如何理解矩阵特征值？ https://www.zhihu.com/question/21874816
[5] L0、L1、L2范数在机器学习中的应用 https://www.jianshu.com/p/4bad38fe07e6
[6] 一文搞懂深度学习正则化的L2范数 https://blog.csdn.net/u010725283/article/details/79212762
[7] 阵与伴随矩阵的关系 https://wenku.baidu.com/view/85d3506f77c66137ee06eff9aef8941ea76e4bd1.html